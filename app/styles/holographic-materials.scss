/**
 * 全息材质效果系统 (Holographic Materials System)
 * Premium UI Enhancement v2 - Phase 3
 * 
 * 基于现有premium-theme变量系统和量子动画系统
 * 实现月付费100美元级别的全息材质视觉效果
 * 
 * Created: 2025-06-10 18:45:00 (obtained by mcp-server-time) +08:00
 * Architecture: AR (Architect) led design, LD (Lead Developer) implementation
 * Core Principles: KISS + DRY + SOLID + Performance Optimization
 */

// {{CHENGQI:
// Action: Created
// Timestamp: 2025-06-10 18:45:00 +08:00
// Reason: P3-AR-013任务 - 创建全息材质效果系统，实现磨砂玻璃、全息边框、光折射效果
// Principle_Applied: KISS(模块化mixin设计) + DRY(复用现有变量系统) + SOLID-S(单一职责材质效果)
// Optimization: GPU硬件加速 + 参数化配置 + 兼容性fallback
// Architectural_Note (AR): 完全基于现有premium-theme和quantum-animations系统，确保架构一致性
// Documentation_Note (DW): 完整的材质效果文档和使用示例，支持团队协作开发
// }}

/* ============================================================================
   1. 导入依赖和基础设置
============================================================================ */

// 导入现有的premium主题变量系统
@import "./premium-theme.scss";
@import "./premium-animations.scss";

/* ============================================================================
   2. 全息材质基础变量系统
============================================================================ */

:root {
  /* 磨砂玻璃效果变量 */
  --holo-glass-blur-subtle: blur(8px);
  --holo-glass-blur-normal: blur(16px);
  --holo-glass-blur-strong: blur(24px);
  --holo-glass-blur-extreme: blur(32px);
  
  --holo-glass-saturation-subtle: saturate(1.1);
  --holo-glass-saturation-normal: saturate(1.3);
  --holo-glass-saturation-strong: saturate(1.5);
  --holo-glass-saturation-extreme: saturate(1.8);
  
  --holo-glass-brightness: brightness(1.1);
  --holo-glass-contrast: contrast(1.2);
  
  /* 全息彩虹效果变量 */
  --holo-rainbow-primary: conic-gradient(
    from 0deg,
    #ff0080 0deg,
    #ff8c00 60deg,
    #40e0d0 120deg,
    #8a2be2 180deg,
    #ff1493 240deg,
    #00bfff 300deg,
    #ff0080 360deg
  );
  
  --holo-rainbow-subtle: conic-gradient(
    from 0deg,
    rgba(255, 0, 128, 0.3) 0deg,
    rgba(255, 140, 0, 0.3) 60deg,
    rgba(64, 224, 208, 0.3) 120deg,
    rgba(138, 43, 226, 0.3) 180deg,
    rgba(255, 20, 147, 0.3) 240deg,
    rgba(0, 191, 255, 0.3) 300deg,
    rgba(255, 0, 128, 0.3) 360deg
  );
  
  /* 光折射效果变量 */
  --holo-refraction-gradient-1: linear-gradient(
    135deg,
    rgba(100, 150, 255, 0.1) 0%,
    rgba(255, 100, 200, 0.1) 25%,
    rgba(100, 255, 150, 0.1) 50%,
    rgba(255, 200, 100, 0.1) 75%,
    rgba(150, 100, 255, 0.1) 100%
  );
  
  --holo-refraction-gradient-2: radial-gradient(
    circle at 30% 30%,
    rgba(100, 150, 255, 0.15) 0%,
    rgba(255, 100, 200, 0.1) 30%,
    rgba(100, 255, 150, 0.08) 60%,
    transparent 100%
  );
  
  --holo-refraction-gradient-3: linear-gradient(
    45deg,
    transparent 30%,
    rgba(255, 255, 255, 0.1) 50%,
    transparent 70%
  );
  
  /* 能量场纹理变量 */
  --holo-energy-pattern-1: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 2px,
    rgba(100, 150, 255, 0.1) 2px,
    rgba(100, 150, 255, 0.1) 4px
  );
  
  --holo-energy-pattern-2: radial-gradient(
    circle at 50% 50%,
    rgba(100, 150, 255, 0.2) 0%,
    transparent 2px
  );
  
  /* 维度效果变量 */
  --holo-perspective-normal: perspective(1000px);
  --holo-perspective-strong: perspective(500px);
  --holo-perspective-extreme: perspective(300px);
  
  --holo-transform-3d: translateZ(0) rotateX(0deg) rotateY(0deg);
  --holo-transform-hover: translateZ(10px) rotateX(-2deg) rotateY(2deg);
  --holo-transform-active: translateZ(5px) rotateX(-1deg) rotateY(1deg);
}

/* ============================================================================
   3. 核心全息材质Mixin库
============================================================================ */

/**
 * 磨砂玻璃效果 Mixin
 * 支持4种强度级别和兼容性fallback
 */
@mixin holo-glass-effect($intensity: normal, $tint: null, $fallback-bg: var(--premium-bg-void)) {
  $blur: var(--holo-glass-blur-#{$intensity});
  $saturation: var(--holo-glass-saturation-#{$intensity});
  
  // 现代浏览器的磨砂玻璃效果
  @supports (backdrop-filter: blur(1px)) {
    backdrop-filter: #{$blur} #{$saturation} var(--holo-glass-brightness) var(--holo-glass-contrast);
    -webkit-backdrop-filter: #{$blur} #{$saturation} var(--holo-glass-brightness) var(--holo-glass-contrast);
    background: rgba(255, 255, 255, 0.05);
    
    @if $tint {
      background: #{$tint};
    }
  }
  
  // 兼容性fallback
  @supports not (backdrop-filter: blur(1px)) {
    background: #{$fallback-bg};
    opacity: 0.95;
  }
  
  // 通用优化
  will-change: backdrop-filter, background;
  transform: translateZ(0); // GPU加速
}

/**
 * 全息彩虹边框效果 Mixin
 * 支持动画和不同样式变体
 */
@mixin holo-rainbow-border($width: 2px, $style: primary, $animated: true, $border-radius: 8px) {
  position: relative;
  border-radius: #{$border-radius};
  
  &::before {
    content: '';
    position: absolute;
    top: -#{$width};
    left: -#{$width};
    right: -#{$width};
    bottom: -#{$width};
    border-radius: inherit;
    background: var(--holo-rainbow-#{$style});
    z-index: -1;
    
    @if $animated {
      animation: holo-rainbow-rotation var(--quantum-duration-cosmic) linear infinite;
    }
    
    // GPU加速
    will-change: transform;
    transform: translateZ(0);
  }
  
  // 内容区域背景（防止透明穿透）
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--premium-bg-void);
    border-radius: calc(#{$border-radius} - #{$width});
    z-index: -1;
  }
}

/**
 * 光折射复合背景效果 Mixin
 * 多层背景+混合模式实现光折射效果
 */
@mixin holo-refraction-background($complexity: normal, $base-bg: var(--premium-bg-void)) {
  background: 
    var(--holo-refraction-gradient-3),
    var(--holo-refraction-gradient-2),
    var(--holo-refraction-gradient-1),
    #{$base-bg};
  
  background-size: 
    200% 200%,
    150% 150%,
    300% 300%,
    100% 100%;
  
  background-position:
    0% 0%,
    100% 100%,
    50% 50%,
    center;
  
  @if $complexity == complex {
    background-blend-mode: overlay, soft-light, color-dodge, normal;
    animation: holo-refraction-shift var(--quantum-duration-galactic) ease-in-out infinite alternate;
  } @else if $complexity == subtle {
    background-blend-mode: soft-light, overlay, normal, normal;
    animation: holo-refraction-shift-subtle var(--quantum-duration-stellar) ease-in-out infinite alternate;
  }
  
  // 性能优化
  will-change: background-position;
  transform: translateZ(0);
}

/**
 * 能量场纹理效果 Mixin
 * SVG patterns + CSS masks结合实现
 */
@mixin holo-energy-field($pattern: 1, $intensity: normal, $animated: true) {
  position: relative;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--holo-energy-pattern-#{$pattern});
    background-size: 20px 20px;
    opacity: 0.3;
    pointer-events: none;
    z-index: 1;
    
    @if $intensity == strong {
      opacity: 0.5;
      background-size: 15px 15px;
    } @else if $intensity == subtle {
      opacity: 0.1;
      background-size: 25px 25px;
    }
    
    @if $animated {
      animation: holo-energy-pulse var(--quantum-duration-atomic) ease-in-out infinite alternate;
    }
    
    // GPU加速
    will-change: opacity, transform;
    transform: translateZ(0);
  }
}

/**
 * 维度切换3D效果 Mixin
 * 透视变换+悬浮状态实现
 */
@mixin holo-dimension-transform($perspective: normal, $hover-enabled: true) {
  perspective: var(--holo-perspective-#{$perspective});
  transform-style: preserve-3d;
  transform: var(--holo-transform-3d);
  transition: transform var(--quantum-duration-molecular) var(--quantum-ease-elastic);
  
  @if $hover-enabled {
    &:hover {
      transform: var(--holo-transform-hover);
    }
    
    &:active {
      transform: var(--holo-transform-active);
    }
  }
  
  // GPU加速和性能优化
  will-change: transform;
  transform-origin: center center;
  backface-visibility: hidden;
}

/**
 * 组合全息效果 Mixin
 * 整合多种材质效果的快捷方式
 */
@mixin holo-composite-effect(
  $glass: true,
  $glass-intensity: normal,
  $rainbow-border: true,
  $rainbow-animated: true,
  $refraction: true,
  $refraction-complexity: normal,
  $energy-field: false,
  $dimension-3d: true
) {
  
  @if $glass {
    @include holo-glass-effect($glass-intensity);
  }
  
  @if $rainbow-border {
    @include holo-rainbow-border($animated: $rainbow-animated);
  }
  
  @if $refraction {
    @include holo-refraction-background($refraction-complexity);
  }
  
  @if $energy-field {
    @include holo-energy-field();
  }
  
  @if $dimension-3d {
    @include holo-dimension-transform();
  }
  
  // 统一的性能优化
  will-change: transform, backdrop-filter, background, box-shadow;
  transform: translateZ(0);
}

/**
 * 性能优化版本 Mixin
 * 用于性能敏感场景的简化版本
 */
@mixin holo-performance-optimized($effect: glass) {
  @if $effect == glass {
    @supports (backdrop-filter: blur(1px)) {
      backdrop-filter: var(--holo-glass-blur-subtle) var(--holo-glass-saturation-subtle);
      background: rgba(255, 255, 255, 0.03);
    }
    @supports not (backdrop-filter: blur(1px)) {
      background: var(--premium-bg-void);
      opacity: 0.9;
    }
  } @else if $effect == rainbow {
    border: 1px solid;
    border-image: var(--holo-rainbow-subtle) 1;
  } @else if $effect == minimal {
    background: var(--premium-bg-void);
    border: 1px solid var(--premium-border-starlight);
    @include starlight-border(subtle);
  }
  
  // 最小化性能影响
  will-change: auto;
  transform: none;
}

/* ============================================================================
   4. 全息材质动画系统
============================================================================ */

/**
 * 彩虹边框旋转动画
 */
@keyframes holo-rainbow-rotation {
  0% {
    transform: translateZ(0) rotate(0deg);
  }
  100% {
    transform: translateZ(0) rotate(360deg);
  }
}

/**
 * 光折射位移动画 - 复杂版本
 */
@keyframes holo-refraction-shift {
  0% {
    background-position: 0% 0%, 100% 100%, 50% 50%, center;
  }
  25% {
    background-position: 25% 25%, 75% 75%, 75% 25%, center;
  }
  50% {
    background-position: 50% 50%, 50% 50%, 100% 50%, center;
  }
  75% {
    background-position: 75% 25%, 25% 75%, 25% 75%, center;
  }
  100% {
    background-position: 100% 100%, 0% 0%, 0% 100%, center;
  }
}

/**
 * 光折射位移动画 - 微妙版本
 */
@keyframes holo-refraction-shift-subtle {
  0% {
    background-position: 0% 0%, 100% 100%, 50% 50%, center;
  }
  50% {
    background-position: 10% 10%, 90% 90%, 60% 40%, center;
  }
  100% {
    background-position: 0% 0%, 100% 100%, 50% 50%, center;
  }
}

/**
 * 能量场脉冲动画
 */
@keyframes holo-energy-pulse {
  0% {
    opacity: 0.1;
    transform: translateZ(0) scale(1);
  }
  50% {
    opacity: 0.4;
    transform: translateZ(0) scale(1.02);
  }
  100% {
    opacity: 0.1;
    transform: translateZ(0) scale(1);
  }
}

/**
 * 全息闪烁效果
 */
@keyframes holo-shimmer {
  0% {
    background-position: -200% center;
  }
  100% {
    background-position: 200% center;
  }
}

/**
 * 维度波动效果
 */
@keyframes holo-dimension-wave {
  0% {
    transform: translateZ(0) rotateX(0deg) rotateY(0deg);
  }
  25% {
    transform: translateZ(2px) rotateX(-0.5deg) rotateY(0.5deg);
  }
  50% {
    transform: translateZ(4px) rotateX(0deg) rotateY(-0.5deg);
  }
  75% {
    transform: translateZ(2px) rotateX(0.5deg) rotateY(0deg);
  }
  100% {
    transform: translateZ(0) rotateX(0deg) rotateY(0deg);
  }
}

/* ============================================================================
   5. 特殊全息效果和应用实例
============================================================================ */

/**
 * 全息卡片效果类
 * 直接应用的CSS类，用于快速原型
 */
.holo-card {
  @include holo-composite-effect(
    $glass: true,
    $glass-intensity: normal,
    $rainbow-border: true,
    $rainbow-animated: true,
    $refraction: true,
    $refraction-complexity: normal,
    $energy-field: false,
    $dimension-3d: true
  );
  
  padding: var(--premium-spacing-md);
  border-radius: var(--premium-border-radius);
  position: relative;
  overflow: hidden;
}

/**
 * 全息按钮效果类
 */
.holo-button {
  @include holo-glass-effect(subtle);
  @include holo-rainbow-border($width: 1px, $animated: false);
  @include holo-dimension-transform(normal, true);
  
  padding: var(--premium-spacing-sm) var(--premium-spacing-md);
  border: none;
  border-radius: var(--premium-border-radius-sm);
  color: var(--premium-text-primary);
  cursor: pointer;
  position: relative;
  
  &:hover {
    @include holo-rainbow-border($width: 1px, $animated: true);
    @include holo-energy-field(1, subtle, true);
  }
  
  &:active {
    transform: var(--holo-transform-active) scale(0.98);
  }
}

/**
 * 全息输入框效果类
 */
.holo-input {
  @include holo-glass-effect(subtle);
  @include holo-refraction-background(subtle);
  
  border: 1px solid var(--premium-border-starlight);
  border-radius: var(--premium-border-radius-sm);
  padding: var(--premium-spacing-sm);
  background-clip: padding-box;
  color: var(--premium-text-primary);
  
  &:focus {
    @include holo-rainbow-border($width: 2px, $animated: true);
    @include holo-energy-field(2, normal, true);
    outline: none;
  }
}

/**
 * 全息模态框效果类
 */
.holo-modal {
  @include holo-glass-effect(strong);
  @include holo-dimension-transform(strong, false);
  @include holo-refraction-background(complex);
  
  border-radius: var(--premium-border-radius);
  padding: var(--premium-spacing-lg);
  position: relative;
  overflow: hidden;
  max-width: 90vw;
  max-height: 90vh;
  
  &::before {
    @include holo-rainbow-border($width: 2px, $animated: true);
  }
}

/* ============================================================================
   6. 响应式和可访问性支持
============================================================================ */

/**
 * 移动端优化
 */
@media (max-width: 768px) {
  .holo-card,
  .holo-modal {
    @include holo-performance-optimized(glass);
  }
  
  .holo-button {
    @include holo-performance-optimized(minimal);
  }
}

/**
 * 低性能设备降级
 */
@media (prefers-reduced-motion: reduce) {
  .holo-card,
  .holo-button,
  .holo-input,
  .holo-modal {
    @include holo-performance-optimized(minimal);
    
    &,
    &::before,
    &::after {
      animation: none !important;
      transition: none !important;
    }
  }
}

/**
 * 高对比度模式支持
 */
@media (prefers-contrast: high) {
  .holo-card,
  .holo-button,
  .holo-input,
  .holo-modal {
    border: 2px solid var(--premium-text-primary);
    background: var(--premium-bg-void);
    
    &::before,
    &::after {
      display: none;
    }
  }
}

/* ============================================================================
   7. 调试和开发辅助
============================================================================ */

/**
 * 调试模式 - 显示全息效果边界
 */
.holo-debug {
  .holo-card,
  .holo-button,
  .holo-input,
  .holo-modal {
    &::before {
      outline: 1px dashed rgba(255, 0, 0, 0.5);
    }
    
    &::after {
      outline: 1px dashed rgba(0, 255, 0, 0.5);
    }
  }
}

/**
 * 性能监控辅助
 */
.holo-performance-monitor {
  position: fixed;
  top: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 10px;
  border-radius: 4px;
  font-family: monospace;
  font-size: 12px;
  z-index: 9999;
  pointer-events: none;
}

/* ============================================================================
   8. 导出和集成准备
============================================================================ */

/**
 * 默认导出所有全息材质变量供其他模块使用
 */
:export {
  holoGlassBlurSubtle: var(--holo-glass-blur-subtle);
  holoGlassBlurNormal: var(--holo-glass-blur-normal);
  holoGlassBlurStrong: var(--holo-glass-blur-strong);
  holoRainbowPrimary: var(--holo-rainbow-primary);
  holoRainbowSubtle: var(--holo-rainbow-subtle);
  holoPerspectiveNormal: var(--holo-perspective-normal);
} 